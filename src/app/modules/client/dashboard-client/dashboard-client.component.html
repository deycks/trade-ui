@if (isLoading) {
<!-- Loading -->
<app-loading></app-loading>
} @else {
@if (showEmptyState) {
<!-- Empty state -->
<div class="mx-auto w-full p-6">
    <div class="rounded-lg border border-dashed border-gray-200 bg-white p-8 text-center">
        <div class="mb-2 text-2xl font-semibold">
            {{ dataDashboard?.uiHints?.emptyState?.title }}
        </div>
        <div class="mb-6 text-sm text-gray-500">
            {{ dataDashboard?.uiHints?.emptyState?.message }}
        </div>
        <!-- <div class="flex justify-center">
            <button mat-flat-button color="primary" class="px-6 py-2">
                Contactar a mi ejecutivo
            </button>
        </div> -->
    </div>
</div>
} @else {
<!-- Dashboard content -->
<div class="flex w-full flex-auto flex-col">
    <div class="mx-auto flex w-full flex-wrap p-6 md:p-8">
        <!-- Title and action buttons -->
        <div class="flex w-full items-center justify-between">
            <div>
                <div class="text-3xl font-semibold leading-8 tracking-tight">
                    Panel de inversión
                </div>
                <div class="text-secondary font-medium tracking-tight">
                    Consulta tu saldo, ganancias y evolución mensual
                </div>
            </div>
        </div>

        <div class="mt-8 grid w-full grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3">
            <!-- Opción para retirar dinero -->
            <div class="flex">
                <div class="bg-white rounded-2xl shadow p-4 flex items-center justify-center w-full md:w-1/2">
                    <button (click)="onWithdrawMoney()"
                        class="flex flex-col items-center justify-center w-full max-w-xs px-4 sm:px-8 py-2 bg-white border-2 border-indigo-600 text-indigo-700 rounded-xl font-semibold text-lg shadow-sm transition hover:bg-indigo-100 hover:border-indigo-700 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-300">
                        <span class="mb-1">
                            <mat-icon svgIcon="heroicons_solid:arrow-up-circle"
                                class="w-7 h-7 text-indigo-600"></mat-icon>
                        </span>
                        <span>Retirar dinero</span>
                    </button>
                </div>
            </div>

            @if (showWithdrawModal) {
            <app-withdraw-modal (close)="handleWithdrawModalClose()"
                (submitTransfer)="handleWithdrawSubmit($event)"></app-withdraw-modal>
            }
            <!-- Evolución de la cuenta -->

            @if (successMessage) {
            <div class="flex flex-auto flex-col overflow-hidden rounded-2xl shadow sm:col-span-2 lg:col-span-3">
                <div class="flex items-center rounded-lg border border-green-200 bg-green-50 p-4 text-green-900 shadow">
                    <svg class="h-6 w-6 flex-shrink-0 text-green-500 mr-3" fill="none" stroke="currentColor"
                        stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M9 12l2 2l4-4m5 2a9 9 0 11-18 0a9 9 0 0118 0z" />
                    </svg>
                    <span class="text-base font-medium">{{ successMessage }}</span>
                </div>
            </div>
            }

            <div
                class="bg-card dark flex flex-auto flex-col overflow-hidden rounded-2xl shadow sm:col-span-2 lg:col-span-3">
                <div class="m-6 mb-0 flex items-start justify-between">
                    <div class="truncate text-lg font-medium leading-6 tracking-tight">
                        Evolución de la cuenta
                    </div>
                </div>

                <div class="mx-6 mt-6 flex items-start">
                    <div class="grid grid-cols-1 gap-8 sm:grid-cols-3 sm:gap-12">
                        <div class="flex flex-col">
                            <div class="flex items-center">
                                <div class="text-secondary font-medium leading-5">
                                    Saldo actual
                                </div>
                                <mat-icon class="text-hint ml-1.5 icon-size-4"
                                    svgIcon="heroicons_mini:information-circle"
                                    [matTooltip]="'Saldo actual es el total disponible en tu cuenta, incluyendo capital y rendimientos acumulados.'"></mat-icon>
                            </div>
                            <div class="mt-2 flex items-start">
                                <div class="text-4xl font-bold leading-none tracking-tight">
                                    {{ dataDashboard?.kpis?.currentBalance| currency:'MXN':'symbol':'1.2-2' }}
                                </div>
                                <div class="ml-2 flex items-center">
                                    <mat-icon class="icon-size-5"
                                        [ngClass]="getTrendColorClass(investedCapitalDeltaPct)"
                                        [svgIcon]="getTrendIcon(investedCapitalDeltaPct)"></mat-icon>
                                    <div class="ml-1 text-md font-medium"
                                        [ngClass]="getTrendColorClass(investedCapitalDeltaPct)">
                                        {{ investedCapitalDeltaPct | number:'1.1-1' }}%
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex flex-col">
                            <div class="flex items-center">
                                <div class="text-secondary font-medium leading-5">
                                    Ganancias acumuladas
                                </div>
                                <mat-icon class="text-hint ml-1.5 icon-size-4"
                                    svgIcon="heroicons_mini:information-circle"
                                    [matTooltip]="'Las ganancias acumuladas son la suma de todos los rendimientos obtenidos hasta la fecha.'"></mat-icon>
                            </div>
                            <div class="mt-2 flex items-start">
                                <div class="text-4xl font-bold leading-none tracking-tight">
                                    {{ dataDashboard?.kpis?.totalProfit| currency:'MXN':'symbol':'1.2-2' }}
                                </div>
                                <div class="ml-2 flex items-center">
                                    <mat-icon class="icon-size-5" [ngClass]="getTrendColorClass(totalProfitPct)"
                                        [svgIcon]="getTrendIcon(totalProfitPct)"></mat-icon>
                                    <div class="ml-1 text-md font-medium"
                                        [ngClass]="getTrendColorClass(totalProfitPct)">
                                        {{ totalProfitPct | number:'1.1-1' }}%
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex flex-col">
                            <div class="flex items-center">
                                <div class="text-secondary font-medium leading-5">
                                    Ganancia del mes
                                </div>
                                <mat-icon class="text-hint ml-1.5 icon-size-4"
                                    svgIcon="heroicons_mini:information-circle"
                                    [matTooltip]="'La ganancia del mes corresponde al rendimiento generado únicamente durante el mes actual.'"></mat-icon>
                            </div>
                            <div class="mt-2 flex items-start">
                                <div class="text-4xl font-bold leading-none tracking-tight">
                                    {{ dataDashboard?.kpis?.profitThisMonth| currency:'MXN':'symbol':'1.2-2' }}
                                </div>
                                <div class="ml-2 flex items-center">
                                    <mat-icon class="icon-size-5" [ngClass]="getTrendColorClass(monthlyProfitPct)"
                                        [svgIcon]="getTrendIcon(monthlyProfitPct)"></mat-icon>
                                    <div class="ml-1 text-md font-medium"
                                        [ngClass]="getTrendColorClass(monthlyProfitPct)">
                                        {{ monthlyProfitPct | number:'1.1-1' }}%
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-3 flex h-80 flex-auto flex-col">
                    <apx-chart class="h-full w-full flex-auto" [chart]="chartVisitorsVsPageViews.chart"
                        [colors]="chartVisitorsVsPageViews.colors" [dataLabels]="chartVisitorsVsPageViews.dataLabels"
                        [grid]="chartVisitorsVsPageViews.grid" [legend]="chartVisitorsVsPageViews.legend"
                        [series]="chartVisitorsVsPageViews.series" [stroke]="chartVisitorsVsPageViews.stroke"
                        [tooltip]="chartVisitorsVsPageViews.tooltip" [xaxis]="chartVisitorsVsPageViews.xaxis"
                        [yaxis]="chartVisitorsVsPageViews.yaxis"></apx-chart>
                </div>
            </div>

            <!-- Capital invertido -->
            <div class="bg-card flex flex-auto flex-col overflow-hidden rounded-2xl shadow sm:col-span-2 lg:col-span-1">
                <div class="m-6 mb-0 flex items-start justify-between">
                    <div class="truncate text-lg font-medium leading-6 tracking-tight">
                        Capital invertido
                    </div>
                </div>

                <div class="mx-6 mt-3 flex flex-col lg:flex-row lg:items-center">
                    <div class="text-7xl font-bold leading-tight tracking-tighter">
                        {{ dataDashboard?.kpis?.investedCapital | currency:'MXN'}}
                    </div>
                    <div class="flex lg:ml-3 lg:flex-col">
                        <mat-icon class="icon-size-5" [ngClass]="getTrendColorClass(investedCapitalDeltaPct)"
                            [svgIcon]="getTrendMiniIcon(investedCapitalDeltaPct)"></mat-icon>
                        <div
                            class="text-secondary ml-1 flex items-center whitespace-nowrap text-md leading-none lg:ml-0 lg:mt-0.5">
                            <span class="font-medium" [ngClass]="getTrendColorClass(investedCapitalDeltaPct)">
                                {{ investedCapitalDeltaPct | number:'1.1-1' }}%
                            </span>
                            <span class="ml-1">del mes</span>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Rendimiento del mes actual -->
            <div class="bg-card flex flex-auto flex-col overflow-hidden rounded-2xl shadow">
                <div class="m-6 mb-0 flex items-start justify-between">
                    <div class="truncate text-lg font-medium leading-6 tracking-tight">
                        Rendimiento del mes actual
                    </div>
                </div>

                <div class="mx-6 mt-3 flex flex-col lg:flex-row lg:items-center">
                    <div class="text-7xl font-bold leading-tight tracking-tighter">
                        {{ dataDashboard?.kpis?.monthlyRate / 100 | percent:'1.1-1'}}
                    </div>
                    <div class="flex lg:ml-3 lg:flex-col">
                        <mat-icon class="icon-size-5" [ngClass]="getTrendColorClass(monthlyProfitPct)"
                            [svgIcon]="getTrendMiniIcon(monthlyProfitPct)"></mat-icon>
                        <div
                            class="text-secondary ml-1 flex items-center whitespace-nowrap text-md leading-none lg:ml-0 lg:mt-0.5">
                            <span class="font-medium" [ngClass]="getTrendColorClass(monthlyProfitPct)">
                                {{ monthlyProfitPct / 100 | percent:'1.1-1'}}
                            </span>
                            <span class="ml-1">desde inicio</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Rendimiento total % -->
            <div class="bg-card flex flex-auto flex-col overflow-hidden rounded-2xl shadow">
                <div class="m-6 mb-0 flex items-start justify-between">
                    <div class="truncate text-lg font-medium leading-6 tracking-tight">
                        Rendimiento total %
                    </div>
                </div>

                <div class="mx-6 mt-3 flex flex-col lg:flex-row lg:items-center">
                    <div class="text-7xl font-bold leading-tight tracking-tighter">
                        {{ dataDashboard?.kpis?.sinceStartReturnPct / 100 | percent:'1.1-1'}}
                    </div>
                    <div class="flex lg:ml-3 lg:flex-col">
                        <mat-icon class="icon-size-5"
                            [ngClass]="getTrendColorClass(dataDashboard?.kpis?.sinceStartReturnPct ?? 0)"
                            [svgIcon]="getTrendMiniIcon(dataDashboard?.kpis?.sinceStartReturnPct ?? 0)"></mat-icon>
                        <div
                            class="text-secondary ml-1 flex items-center whitespace-nowrap text-md leading-none lg:ml-0 lg:mt-0.5">
                            <span class="font-medium"
                                [ngClass]="getTrendColorClass(dataDashboard?.kpis?.sinceStartReturnPct ?? 0)">
                                {{ (dataDashboard?.kpis?.sinceStartReturnPct ?? 0) * 100 | number:'1.1-1' }}%
                            </span>
                            <span class="ml-1">vs capital</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Visitors overview -->
            <!-- <div
                class="bg-card dark flex flex-auto flex-col overflow-hidden rounded-2xl shadow sm:col-span-2 lg:col-span-3">
                <div class="ml-10 mr-6 mt-10 flex items-center justify-between sm:mr-10">
                    <div class="flex flex-col">
                        <div class="mr-4 text-2xl font-semibold leading-7 tracking-tight md:text-3xl">
                            Visitors Overview
                        </div>
                        <div class="text-secondary font-medium">
                            Number of unique visitors
                        </div>
                    </div>

                    <div class="ml-2">
                        <mat-button-toggle-group class="hidden space-x-1 border-none sm:inline-flex" value="this-year"
                            #visitorsYearSelector="matButtonToggleGroup">
                            <mat-button-toggle class="overflow-hidden rounded-full border-none px-1.5 font-medium"
                                value="last-year">
                                Last Year
                            </mat-button-toggle>
                            <mat-button-toggle class="overflow-hidden rounded-full border-none px-1.5 font-medium"
                                value="this-year">
                                This Year
                            </mat-button-toggle>
                        </mat-button-toggle-group>

                        <div class="sm:hidden">
                            <button mat-icon-button [matMenuTriggerFor]="visitorsMenu">
                                <mat-icon svgIcon="heroicons_outline:ellipsis-vertical"></mat-icon>
                            </button>
                            <mat-menu #visitorsMenu="matMenu">
                                <button mat-menu-item>This Year</button>
                                <button mat-menu-item>Last Year</button>
                            </mat-menu>
                        </div>
                    </div>
                </div>

                <div class="flex h-80 flex-auto flex-col">
                    <apx-chart class="h-full w-full flex-auto" [chart]="chartVisitors.chart"
                        [colors]="chartVisitors.colors" [dataLabels]="chartVisitors.dataLabels"
                        [fill]="chartVisitors.fill" [grid]="chartVisitors.grid"
                        [series]="chartVisitors.series[visitorsYearSelector.value]" [stroke]="chartVisitors.stroke"
                        [tooltip]="chartVisitors.tooltip" [xaxis]="chartVisitors.xaxis"
                        [yaxis]="chartVisitors.yaxis"></apx-chart>
                </div>
            </div> -->
        </div>
    </div>
</div>
}
}
